<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit Resume in YAML Format</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/emoji-css/1.0.0/emoji.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.0/codemirror.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.0/theme/dracula.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
            font-family: 'Arial', sans-serif;
        }
        .container {
            max-width: 900px;
            margin: 50px auto;
        }
        .yaml-data {
            margin-top: 30px;
            white-space: pre-wrap;
            background-color: #f1f1f1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-family: monospace;
        }
        .editor-container {
            margin-top: 30px;
        }
        #yaml-error {
            color: red;
            margin-top: 10px;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>Edit Resume in YAML Format</h1>

    <!-- YAML Editor -->
    <div class="editor-container">
        <textarea id="yaml-editor"></textarea>
    </div>

    <!-- Error message -->
    <div id="yaml-error"></div>

    <button class="btn btn-primary mt-4" onclick="saveYAML()">Save YAML</button>
    <button class="btn btn-secondary mt-4" onclick="viewYAMLData()">View YAML Data</button>

    <div class="yaml-data" id="yaml-output" style="display: none;"></div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/js-yaml@4.0.0/dist/js-yaml.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.0/codemirror.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.0/mode/yaml/yaml.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.0/addon/lint/lint.min.js"></script>

<script>
    // Initialize CodeMirror for YAML editing
    var editor = CodeMirror.fromTextArea(document.getElementById("yaml-editor"), {
        mode: "yaml",
        theme: "dracula",
        lineNumbers: true,
        lint: true,
        gutters: ["CodeMirror-lint-markers"]
    });

    // Load YAML data from localStorage if exists
    window.onload = function() {
        const savedYAML = localStorage.getItem('resumeYAML');
        if (savedYAML) {
            editor.setValue(savedYAML);
        }
    };

    // Save YAML to localStorage
    function saveYAML() {
        const yamlContent = editor.getValue();
        try {
            // Validate YAML syntax
            jsyaml.load(yamlContent);  // Throws error if YAML is invalid
            localStorage.setItem('resumeYAML', yamlContent);
            alert('YAML data saved successfully!');
        } catch (e) {
            displayError(e.message);
        }
    }

    // Display error message if YAML is invalid
    function displayError(errorMessage) {
        const errorElement = document.getElementById('yaml-error');
        errorElement.textContent = 'YAML Syntax Error: ' + errorMessage;
    }

    // View YAML data from localStorage
    function viewYAMLData() {
        const savedYAML = localStorage.getItem('resumeYAML');
        if (savedYAML) {
            const formattedYAML = jsyaml.dump(jsyaml.load(savedYAML));
            document.getElementById('yaml-output').textContent = formattedYAML;
            document.getElementById('yaml-output').style.display = 'block';
        } else {
            alert('No YAML data found in localStorage.');
        }
    }
</script>
</body>
</html>
